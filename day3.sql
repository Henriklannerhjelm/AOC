CREATE TABLE #hl_temp( id int IDENTITY,grid varchar(50))
INSERT INTO #hl_temp (grid) select '.#..#....##...#....#.....#.#...'  union all select'........##....#..#..##....#.#..' union all select'......##......##.........#....#' union all select'...#.....#....##.......#.#....#' union all select'.#.###.#.#..#.....##..#....#.#.' union all select'##.........##.....####......#..' union all select'#...#..........#.##............' union all select'####............#..........#.#.' union all select'......#......#....##...#..##...' union all select'#..#....#...#......#......####.' union all select'......#..........#.........#.#.' union all select'...##.......#..#.#..#..#....#..' union all select'..####....#.#...............##.' union all select'...###........#.....#..........' union all select'#..#.##...##.#..##...##...#....' union all select'.###........#.##..#.#.....#....' union all select'.#.......#..##.......#......#..' union all select'.##...........#..............#.' union all select'...#..#.....#...........#...#..' union all select'.....#..............#..#.......' union all select'.......#....#.....##...........' union all select'.#...#.............#.....##....' union all select'....#.#....#...#...#..#..##.#..' union all select'...#..##..##...#..##........#.#' union all select'.###..#...#.#.#.#..#...#.......' union all select'.....##.#.##.#.#.......#..#....' union all select'.##.#...#.....#...#....#.....#.' union all select'.....#......###....###..##.#..#' union all select'.....#..##....#..#.#..#.#.#....' union all select'#....#.....#.#.......#...#....#' union all select'...#........#............#..#..' union all select'#.#...#...#..##.........#...##.' union all select'.#..#.#...........#....#...#...' union all select'##..#.#..........#.....###...#.' union all select'#..#........#.......#.#..#....#' union all select'..#...##....#..#....#....#.....' union all select'...#.....##....#...#..#....##.#' union all select'.....#......#...#.#.#.#.#......' union all select'###.....#..#.#..........##.#...' union all select'...............#..#...#.#....#.' union all select'#.....#.....###....#..........#' union all select'........#...#.#.......#..#...#.' union all select'..#.##...#...#...#.........#...' union all select'#..........#..#.#...........##.' union all select'##.......#.#.#...#.....#.......' union all select'...#.#.#.....#......#....##..#.' union all select'##.#.....#....#...#.......#....' union all select'.#......##..#.##.#....##..##.#.' union all select'..#..#......#....#...#..#.#....' union all select'...#..###...#.......#..#.......' union all select'...#....#..#....#........##....' union all select'#...#...#....#.#.........###.#.' union all select'.#.........##..##...#..........' union all select'...##.....##.........#..#..#...' union all select'###....#......#.##..#...#......' union all select'.###....#.#.......#..#....#...#' union all select'....####........##....#.#....##' union all select'..#.....#......##...#..#..#....' union all select'...#....#...#......#.###.#.#.#.' union all select'......#.......#..#...#...#.....' union all select'.#...#...#..#.#..........#.....' union all select'........#..#.........#.#....##.' union all select'.#....#.......#........#.##.#..' union all select'...#...#..#.....#......#...##..' union all select'.#.................#........###' union all select'.......#.#..#.#...#............' union all select'.#.......#..##...#.###....#.##.' union all select'#........#.###.#..#........##..' union all select'..##.#....##......##........#..' union all select'...............#...............' union all select'#.......#......##..#.#....#.#.#' union all select'..#.....#......#.#.#...#...##..' union all select'..........#........#.....##...#' union all select'#..........#.#..#..##..#......#' union all select'.......#..###..##.#..##........' union all select'#.#..##..###..#.###.....#.#..##' union all select'..#.#........#...###...##......' union all select'.......##.....##...#.##........' union all select'.#.#...###..#..#......##....##.' union all select'#...#.#.....##..#..#..#.#....#.' union all select'........#......#....#..#.......' union all select'...#.#.#.#........###....#...#.' union all select'.#......#...#.......#......#...' union all select'#...#.##.#..#.#..#.........#...' union all select'....#......##......#........#.#' union all select'..##.#.....#..#......#..#......' union all select'#.##...##...#................#.' union all select'.....#..#....#....#####........' union all select'....#..#..#.#...#.#............' union all select'.........#.#....#..#....##...#.' union all select'#....#..........#......#......#' union all select'.......#..............#......#.' union all select'.#..#...#..#.#.....#.#.#.##.#..' union all select'.##........#......#...#.##.....' union all select'...#.##..#........#...........#' union all select'..#...#..#........#.......#.#..' union all select'#.....#..#.#..#..#...#...#..#..' union all select'..................#.#.....#...#' union all select'........#...##.#..#.........#..' union all select'.#...##.#...........##.##...#..' union all select'#......#.........#...#...#...#.' union all select'..........#.............#...#..' union all select'#............##.#..#...#.#...#.' union all select'..#.##...##....##.#...####...#.' union all select'#.##..#......#.......#.#...##..' union all select'.....#...#..#......#####.##..#.' union all select'#...#.#.##..#..##.....#......#.' union all select'.#..#......#.#.#...#.#...##.#..' union all select'.#.....#..##........#.....#...#' union all select'.................#..........#..' union all select'##.#.#......#.####..#.....#....' union all select'.#...##.####..#...#............' union all select'..#...............###....#....#' union all select'#...#..###..#.#.##...........##' union all select'...................#..#.....#..' union all select'...#.##.#...#.....#......#.##..' union all select'#.#...#.........##.#........#.#' union all select'.##.......#..#..#.....##....#..' union all select'......##.#.#..#...#.#..##.....#' union all select'..#..###...#...#......#.#......' union all select'..##....#.#...#....#....#..#..#' union all select'#..##....#........#..##..#..#.#' union all select'.......#............#....##..#.' union all select'.#.#..#.........#.#.##......#..' union all select'#.#....#..##..#..###.#.....##..' union all select'.###.#......#.....#####...#....' union all select'#...#.#...##......#...#.#...##.' union all select'#..#.........#..#............#.' union all select'...##......##.......##....##...' union all select'...#...##....###..###.#...#....' union all select'#.#....#...#.#...##..#........#' union all select'.#..#..................#....#..' union all select'#......#..#...##..##...#..##..#' union all select'...#..#.....#...#........#.#.#.' union all select'#...#..##....#.....#........#..' union all select'.##..#....#.....#.#............' union all select'##..##.#.#.##.#.#..#.#..#....#.' union all select'#.......#...............#.....#' union all select'..#.....#..##.....#...##.##....' union all select'...#..#...#.#.#....#......#....' union all select'###.#.......#....#....#.#...#..' union all select'.....###..#...###.#.#..#.......' union all select'.....#.........##.#....#..##.#.' union all select'........#....#....#....#.#..##.' union all select'........###....#.#.........#.#.' union all select'.#..###..#........#.......##.#.' union all select'.#.#...........................' union all select'..#....##...#.#....#....#.#....' union all select'.#...#...##.#........###....#..' union all select'#.#....#...#.#.#...##......##..' union all select'#......#....#...#..#....#...#..' union all select'...#..##........#.#...##......#' union all select'....##...........##...#..#..#..' union all select'......#..#........#..#....##.##' union all select'.###..#.#.........#.....#......' union all select'.#..##............#......#.....' union all select'..##.#.#..#..#.###....#..#..#..' union all select'....#.#..#.#..##...##.#.#.#.#..' union all select'....#..#....#...............#..' union all select'..#...#.##.....##....#..##..#..' union all select'.......##.#....#.##....#.......' union all select'.#...#........#...#......#.###.' union all select'..#....##.......#....#.#...#.#.' union all select'.....#.....#...##..#....#.#..##' union all select'..##........##............##...' union all select'..........#...#.......#.......#' union all select'.#...............#...#.##......' union all select'#.##......#....#.##.#..#..#...#' union all select'......###.........#...#..#....#' union all select'....#......#...#....#....#...#.' union all select'#...##...#....#......####....#.' union all select'.................#......#......' union all select'..#..........##.......##..#.##.' union all select'.#.....#.......#...######..#..#' union all select'....##.#...#...#..........#....' union all select'.....#.......#...#.#.......###.' union all select'#...#.###.....#...#.......#....' union all select'.#.##.####....#.....#.#........' union all select'.......#.....##............##..' union all select'..#...#.#.##........#...##...#.' union all select'........#...####.##..#....#...#' union all select'#.......#...##.#......#..#...#.' union all select'......#.........#..###.#.#....#' union all select'#..##...#...#..#...#...#.....#.' union all select'.#...#...#.#.................##' union all select'#......#.....#..#.#..#......##.' union all select'.......#.##...#.......#.......#' union all select'.#.#..#..#......#....#.#...#.#.' union all select'..#...#.#..#......#...#.#.#....' union all select'........#..............#..##...' union all select'.##..#..##.#....#.#..###..#..#.' union all select'..#....#......#...#.#.#....#...' union all select'...#..#..#....#..#.....##......' union all select'.#......#...#........##........' union all select'.#......#..#...##..#..#.#.#....' union all select'.##......#.##.........#....#...' union all select'....#....##..#..###.#..#......#' union all select'....#....##..........#.#...#...' union all select'..##.#.............#..#.....#..' union all select'..#.....#....#....#.......##...' union all select'.##.#....#....#...#....##.#....' union all select'...#.#..#.###.#..#.#.......#.#.' union all select'.....##.....#.......#......#...' union all select'.#.....#..#.#.#..#........##...' union all select'##.....................#.......' union all select'..###............#........##..#' union all select'.#.##.....#..#..#..#.#.......#.' union all select'.##...................#..#..#..' union all select'..#.#...#..........##..#..##...' union all select'#......#..#..#.#..#......#..#.#' union all select'.#...#....#.#.........#.....#.#' union all select'#..........#.#....#....#.#.#.#.' union all select'#.....#..........#..#....#..#..' union all select'........#....#..##.#.#.......#.' union all select'.#.......##.......#..##...#....' union all select'...#..##..#......##.#..#.#..#..' union all select'.#..#.......#..##..#......#....' union all select'###.#.........#......#.#.......' union all select'...#......#....#..##..#.#..#...' union all select'......#..#.....#.........#....#' union all select'....#..#..#..#.........##.#..#.' union all select'......#..#..#..#....#...#..##.#' union all select'......##.#..#..#.#.......#.#.##' union all select'..#.....#...#..#....#..........' union all select'.##..##.....##.......#.##.#....' union all select'...#..#.......#..#.......#.....' union all select'.........#....##..#.#....#.#...' union all select'.....#..#...#.........#....#..#' union all select'.........##.....#.#...#.###...#' union all select'.#......####..##...#..#........' union all select'.#......##....#.....#..........' union all select'##.......##.#.......#..........' union all select'.#......#.#.#.#....#........#..' union all select'......##..##...#...#...........' union all select'.#...#.#..#......#.#.#.#....#.#' union all select'...#.........#.....#...###.....' union all select'#.....##....#.##...#....#......' union all select'.#..#...#..##.###.#.#.#...#....' union all select'...#......#..#....#...#...#....' union all select'.#..............#.....#........' union all select'..##...#.....#..#.....#..#.#...' union all select'.##...#....#.##...#.........##.' union all select'..#......#...##..#.....#......#' union all select'#.#..............#...#...#..#.#' union all select'..#..#.#...........#...#.#.#...' union all select'#..........#...#..#..##..#....#' union all select'............#...#........###...' union all select'.........#.....#.....#..#......' union all select'#...#.#..##......#.#####.......' union all select'...#........#..............#...' union all select'......###.#.#.....#..#....##.#.' union all select'.#.#.#..##....###.#..#....##...' union all select'.#....#.##............##.#.....' union all select'##...##.#......#.#.##.##...###.' union all select'.......#.#........#.....#......' union all select'....#.....#......#...#.#..#....' union all select'.#.........#....#...#...#...#.#' union all select'#.......#................#..#..' union all select'.##...........#.##...##....#...' union all select'#...#.#...###.........#.......#' union all select'.#...#.........................' union all select'#.......#...#.....##.##...##...' union all select'.#.#....#.......#.#.##.#....#..' union all select'#..#....#...#.#.##.#....#....#.' union all select'.##.....#.#..#...#..#..........' union all select'.............#...#.#..#........' union all select'....#........#..#......##......' union all select'#.....#....#.....#.......#.....' union all select'........#.......##....#........' union all select'.#.#..##.......................' union all select'##..#.....#........#.....#.....' union all select'.#......#.#...#.#..........#..#' union all select'.#..#.....#..#..........#.###..' union all select'......#.#..#.#.......#.#.....#.' union all select'.#....#......#..##.............' union all select'#...##.........#.#.#...#.....#.' union all select'..#................#..#..###...' union all select'#.....#....##.#..##......#.#.#.' union all select'..#....#...#...#...............' union all select'#................#....#...#.#..' union all select'................#...#.....#.##.' union all select'..#.#.#..#.##.......##.......##' union all select'...........#......##.......###.' union all select'...#.......##.........#.#.#.#..' union all select'.#...#.#..#...#.#.....#........' union all select'............#####......##......' union all select'....###....#.##...#..#.........' union all select'..#.#...#.......#...#...#.###..' union all select'..............##..#...#....#...' union all select'#.#..##...#....##.........#....' union all select'..#...#.....#...........#...#..' union all select'#.#..###..#.#..#........#..#.#.' union all select'...###...##...#...#.#.........#' union all select'..#........#.....#.#.#.......#.' union all select'...#..#..........#.....#...#...' union all select'....#..#.....#....##....#.##...' union all select'.....##..#...#.#..##...#...##.#' union all select'...........###...##....#.......' union all select'##..#.#..#..#...#....##..#..#..' union all select'##...#.#......##.#..#...#....#.' union all select'.#.......#...........#...#.....' union all select'#...#....#.......#...#.##......' union all select'.........#.......#...#.#...#...' union all select'.......##.#..................#.' union all select'........#..#.#......#.....#....' union all select'.....#.#.#.#....##...#.###.....' union all select'#.#.........#..#.#.#.#.#.......' union all select'.............#....#.......###..' union all select'.#.##....#....##.........####..' union all select'...........###.#...............' union all select'#.........##.#.#..#.....##.###.' union all select'.#.#.....#.#...#.....##...#...#' union all select'#....#...#.........#.#.......#.' union all select'.....#.###..#....#...##..#...#.' union all select'#........#....#.#..#....#.#....' union all select'#.#..##......#.........#.#.....' union all select'##..#.....#......###....#....#.' union all select'#.#.####..#.#.#......##...#..#.' union all select'....#.....#.#.#.#.....#........' union all select'..##..........#......#.#.#..#..' union all select'.#...##.##.........#.........##' union all select'..#.#.#..........#..#..#......#' union all select'###..###..#...#................'
SELECT * INTO #hl_move FROM (select 1 as id,1 as x,1 as y union all select 2,3,1	union all select 3,5,1 union all select 4,7,1 union all select 5,1,2) as temp

DECLARE @case int = 1,@result DECIMAL(15,0) = 1
WHILE(@case<6)
BEGIN
	DECLARE @currentRow int = 1,@currentPos int = 1,@hitCount int = 0
	WHILE(@currentRow<324)
	BEGIN
		SELECT @hitCount = @hitCount + CASE WHEN SUBSTRING(grid,@currentPos,1)='#' THEN 1 ELSE 0 END,@currentRow=@currentRow+y, @currentPos=(@currentPos+x) from #hl_temp t inner join #hl_move m ON m.id=@case where t.id=@currentRow
		IF(@currentPos>31) SET @currentPos=@currentPos%31
	END
	SELECT @case as id,@hitCount
	SELECT @case=@case+1,@result=@result*@hitCount
END
SELECT @result